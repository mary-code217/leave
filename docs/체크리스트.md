# 휴가 전자결재 시스템 구현 체크리스트

> 마지막 업데이트: 2025-12-31

## 구현 현황 요약

| 상태 | 개수 |
|------|------|
| ✅ 완료 (90%+) | 9개 |
| 🔶 부분 구현 (50-89%) | 8개 |
| ❌ 미구현 (0-49%) | 6개 |

---

## I. 휴가 부여 및 관리

### SFR-101 [연차 부여] 🔶 85%
- [x] 근속연수에 따른 유급연차 자동 부여 로직 (`AccrualPolicyEngine`)
- [x] 1년 미만 월 1일 부여 (`LeaveStage.MONTHLY`)
- [x] 1년 이상 연 15일 부여 (`LeaveStage.ANNUAL`)
- [x] 휴가 변동 원장 기록 (`UserLeaveLedger`)
- [x] 변경 사유 코드 관리 (`ReasonCode`)
- [ ] 관리자 수동 부여/차감 API
- [ ] 유급연차 잔여 0일 시 무급연차 자동 전환
- [ ] 변경 이력 상세 조회 API

### SFR-102 [연차 종류 설정] ✅ 95%
- [x] 휴가 유형 등록/수정/삭제 (`LeaveType`, `LeaveTypeService`)
- [x] 유형별 차감 여부 설정 (`leaveDecrement`)
- [x] 증빙 필요 여부 설정 (`requiresAttachment`)
- [x] 휴가 유형 REST API (`LeaveTypeController`)
- [ ] 승인 절차 설정 연동

### SFR-103 [휴가 잔여 관리] 🔶 75%
- [x] 유급 잔여일 관리 (`UserLeaves.balanceDays`)
- [x] BigDecimal 기반 정밀 계산
- [x] 모든 변동 내역 원장 기록 (`UserLeaveLedger`)
- [ ] 무급 잔여일 별도 집계
- [ ] 반차 0.5일 차감 로직
- [ ] 시간단위 최소 2시간 및 2시간 단위 차감
- [ ] 동일일자 오전·오후 반차 합산 시 1일 처리

---

## II. 신청 및 결재

### SFR-110 [휴가 신청] 🔶 60%
- [x] 휴가 신청 엔티티 (`LeaveRequest`)
- [x] 기간 입력 (`startDay`, `endDay`)
- [x] 시간 입력 (`startTime`, `endTime`)
- [x] 유형 선택 (`LeaveType` 참조)
- [x] 휴가 신청 REST API (`LeaveRequestController`)
- [ ] 휴가 계정 유효성 검증 로직 (미구현 - `LeaveRequestModifyFacade`)
- [ ] 반차 신청 시 오전/오후 필수 선택 검증
- [ ] 공휴일·주말 자동 차감 제외
- [ ] 인수인계 메모 연결
- [ ] 결재선 자동 설정
- [ ] 알림 발송 연동

### SFR-111 [결재선 관리] ✅ 90%
- [x] 사용자별 기본 결재자 지정 (`UserDefaultApprover`)
- [x] 다단계 결재 지원 (`stepNo`)
- [x] 결재 단계별 승인 정보 (`LeaveRequestApproval`)
- [x] 결재 상태 관리 (`ApprovalStatus`)
- [x] 결재선 REST API (`UserDefaultApproverController`)
- [x] 대리결재 위임 엔티티 (`ApproverDelegation`)
- [ ] 본인 결재 불가 검증 로직
- [ ] 대리결재 서비스 로직

### SFR-112 [사후결재] ❌ 30%
- [x] 휴가 시작일 필드 존재 (`startDay`)
- [x] 결재 상태 관리 (`LeaveRequestStatus`)
- [ ] 사후결재 판정 로직 (시작일 vs 신청일 비교)
- [ ] 사후결재 여부 표시 필드
- [ ] 사후결재 사유 필수 입력 검증

---

## III. 검증 규칙 및 정책

### SFR-120 [리드타임/취소] ❌ 30%
- [x] 취소 상태 정의 (`LeaveRequestStatus.CANCELED`)
- [ ] 최소 신청일수 설정 엔티티
- [ ] 리드타임 검증 로직
- [ ] 시작일 이후 취소 시 결재자 승인 필요 로직

### SFR-121 [중복·겹침 제한] 🔶 85%
- [x] 팀별 동시휴가 인원 제한 (`LeaveConcurrencyPolicy`)
- [x] 최대 동시 허용 인원 설정 (`maxConcurrent`)
- [x] 정책 유효 기간 설정 (`effectiveFrom`, `effectiveTo`)
- [x] 동시정책 REST API (`LeaveConcurrencyController`)
- [ ] 동일 사용자 일정 겹침 불가 검증
- [ ] 신청 시 동시정책 실제 적용

### SFR-122 [공휴일 처리] 🔶 85%
- [x] 공휴일 엔티티 (`Holiday`)
- [x] 공휴일 CRUD API (`HolidayController`)
- [x] 공공데이터포털 API 연동 (`HolidaySyncService`)
- [x] 공휴일 정기 동기화 (`HolidaySchedulerService`)
- [ ] 휴가 기간 공휴일 자동 차감 제외 계산

---

## IV. 알림 및 사용자 편의

### SFR-130 [웹 알림] ✅ 90%
- [x] 알림 엔티티 (`Notification`)
- [x] 알림 유형 정의 (`NotificationType`)
  - [x] LEAVE_APPROVAL_REQUESTED
  - [x] LEAVE_STATUS_CHANGED
  - [x] HANDOVER_ASSIGNED
  - [x] LEAVE_BALANCE_ADJUSTED
- [x] 알림 생성 서비스 (`NotificationService`)
- [x] 알림 REST API (`NotificationController`)
- [ ] 실시간 WebSocket 연결
- [ ] 각 이벤트별 알림 자동 트리거

### SFR-131 [이메일/모바일 알림] ❌ 0%
- [ ] 이메일 발송 서비스
- [ ] 모바일 푸시 서비스
- [ ] 알림 채널 설정 기능

### SFR-132 [캘린더 뷰] ❌ 0%
- [ ] 캘린더 조회 API
- [ ] 팀/조직별 월·주·일 단위 휴가 현황
- [ ] 유급/무급, 반차, 시간단위 구분 표시
- [ ] 당일 팀 내 휴가 인원수 배지 표시

---

## V. 관리 기능

### SFR-140 [관리자 화면] 🔶 80%
- [x] 휴가 유형 관리 (`LeaveTypeController`)
- [x] 결재선 관리 (`UserDefaultApproverController`)
- [x] 공휴일 관리 (`HolidayController`)
- [x] 동시정책 관리 (`LeaveConcurrencyController`)
- [x] 팀 관리 (`TeamController`)
- [x] 직급 관리 (`GradeController`)
- [x] 직책 관리 (`PositionController`)
- [x] 관리자 API (`AdminController`)
- [ ] 연차 일괄 부여/차감 기능
- [ ] 연차/무급 사용량 통계 조회

### SFR-141 [감사 로그] ✅ 90%
- [x] 감사 로그 엔티티 (`AuditLog`)
- [x] 액션 유형 정의 (`Action`: CREATE/UPDATE/DELETE)
- [x] 작업자/대상/시간 기록
- [x] 감사 로그 서비스 (`AuditLogService`)
- [x] 감사 로그 REST API (`AuditLogController`)
- [ ] 모든 변경에 대한 자동 로깅
- [ ] 3년 자동 보관/삭제 정책

---

## VI. 권한 및 직급 관리

### SFR-150 [직급·직책 관리] ✅ 100%
- [x] 직급 엔티티 (`Grade`)
- [x] 직급 CRUD (`GradeService`, `GradeController`)
- [x] 직책 엔티티 (`Position`)
- [x] 직책 CRUD (`PositionService`, `PositionController`)
- [x] 정렬 순서 관리 (`orderNo`)

### SFR-151 [권한 역할 정의] ✅ 100%
- [x] 역할 열거형 (`UserRole`)
  - [x] ROLE_USER: 본인 신청/조회
  - [x] ROLE_APPROVER: 하위 조직 결재
  - [x] ROLE_ADMIN: 조직·직급·결재선 관리
- [x] 사용자 역할 필드 (`User.role`)
- [x] 권한 기반 접근 제어 (`SecurityConfig`)

### SFR-152 [조직도 관리] ✅ 100%
- [x] 팀 엔티티 (`Team`)
- [x] 계층형 조직도 (`parent`, `children`)
- [x] 팀 이동 시 사이클 검증 (`moveTo()`)
- [x] 팀 CRUD (`TeamService`, `TeamController`)

---

## VII. 계정 생성 및 사용자 관리

### SFR-160 [계정 생성] ✅ 95%
- [x] 사용자 엔티티 (`User`)
- [x] 기본정보: 사번, 이름, 이메일, 입사일
- [x] 직급, 직책, 소속팀 연결
- [x] 기본 역할 설정 (`role`)
- [x] 사용자 등록 API (`UserController`)
- [x] 초기 연차 부여 (`LeaveAccountService.firstCreateUserLeaves()`)
- [ ] 초기 비밀번호 이메일 자동 발송

### SFR-161 [계정 활성/비활성] 🔶 50%
- [x] 활성 상태 필드 (`User.active`)
- [ ] 계정 비활성화 전용 API
- [ ] 비활성 계정 로그인 차단 로직
- [ ] 이력 조회 API

### SFR-163 [비밀번호 정책] ❌ 40%
- [x] 비밀번호 암호화 (`BCryptPasswordEncoder`)
- [x] 비밀번호 변경 기능 (`User.updatePassword()`)
- [ ] 최소 8자 + 영문/숫자/특수문자 검증
- [ ] 90일 주기 변경 안내
- [ ] 5회 오류 시 계정 잠금
- [ ] 관리자 잠금 해제 기능

---

## VIII. 관리자 기능 확장 (권한/계정 관련)

### SFR-170 [사용자 일괄 업로드] ❌ 0%
- [ ] CSV 파일 파싱
- [ ] Excel 파일 파싱
- [ ] 대량 사용자 등록 API
- [ ] 조직·직급·결재자 매핑

### SFR-171 [역할 변경 이력] ❌ 0%
- [ ] 역할 변경 기록 엔티티/로직
- [ ] 변경자, 사유, 일시 기록
- [ ] 3년 보관 정책

### SFR-172 [감사 로그(권한/계정)] 🔶 50%
- [x] 감사 로그 기본 구조 (`AuditLog`)
- [ ] 계정 생성 자동 로깅
- [ ] 권한 변경 자동 로깅
- [ ] 직급 변경 자동 로깅
- [ ] 조직 이동 자동 로깅
- [ ] 휴가유형 변경 자동 로깅

---

## 추가 구현된 기능

### 인수인계 기능 ✅ 90%
- [x] 인수인계 메모 엔티티 (`HandoverNote`)
- [x] 인수자 지정 (`HandoverRecipient`)
- [x] 인수인계 CRUD API (`HandoverController`)
- [ ] 휴가 신청과 연결

---

## 핵심 미구현 사항 (우선순위)

### 🔴 1순위 - 핵심 기능
1. `LeaveRequestModifyFacade.createLeaveRequest()` 완성
2. 휴가 신청 시 잔여일 차감 처리
3. 공휴일 자동 제외 계산

### 🟠 2순위 - 검증 로직
1. 동일 사용자 일정 겹침 검증
2. 본인 결재 불가 검증
3. 대리결재 서비스 구현

### 🟡 3순위 - 편의 기능
1. 이메일/푸시 알림 서비스
2. 캘린더 뷰 API
3. CSV/Excel 일괄 업로드
4. 통계 조회 기능
